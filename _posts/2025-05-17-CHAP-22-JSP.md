---
layout: post
title: "CHAP 3-4. JSP + Ajax μ—°λ™"
date: 2025-05-17
categories: [backend, language, jsp]
tags: [backend, language, jsp]
thumbnail: /assets/img/post-thumbnails/intro2.png
author: Devchanny
---


# ** π“ JSP + Ajax μ—°λ™ **

> JSPμ—μ„ λΉ„λ™κΈ° Ajax μ”μ²­μ„ λ°›μ•„ JSONμΌλ΅ μ‘λ‹µν•λ” μ „μ²΄ νλ¦„
> 
> 
> μ„λ²„ β†’ ν΄λΌμ΄μ–ΈνΈ ν†µμ‹  κµ¬μ΅° + μ‹¤μ „ μμ  μ™„μ „ μ •λ¦¬
> 

---

## π§© λ©μ°¨

1. κ°λ… μ •λ¦¬
2. μ „μ²΄ νλ¦„λ„
3. Ajax κµ¬μ„±μ”μ† ν•µμ‹¬
4. ν΄λΌμ΄μ–ΈνΈ(fetch) β†’ μ„λ²„(JSP) μ”μ²­ κµ¬μ΅°
5. μ„λ²„(JSP) β†’ JSON μ‘λ‹µ μ²λ¦¬
6. μ‹¤μ „ μμ  (λ“κΈ€ λ©λ΅ μ΅°ν)
7. κΈ°μ  λ©΄μ ‘ λ€λΉ„ ν•µμ‹¬ μ”μ•½
8. λ§λ¬΄λ¦¬ μ”μ•½ + Notion μ‘μ„± ν

---

## β… 1. κ°λ… μ •λ¦¬

| ν•­λ© | μ„¤λ… |
| --- | --- |
| Ajax | νμ΄μ§€ μ „μ²΄ μƒλ΅κ³ μΉ¨ μ—†μ΄ μ„λ²„μ™€ λ°μ΄ν„°λ¥Ό μ£Όκ³ λ°›λ” λ°©μ‹ (Asynchronous JS + XML) |
| JSON | μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈκ°€ λ°μ΄ν„°λ¥Ό μ£Όκ³ λ°›μ„ λ• μ‚¬μ©ν•λ” λ€ν‘μ μΈ κ²½λ‰ λ°μ΄ν„° ν¬λ§· |
| JSP μ—­ν•  | ν΄λΌμ΄μ–ΈνΈ μ”μ²­ μ²λ¦¬ β†’ DB μ΅°ν β†’ JSON μ‘λ‹µ μƒμ„± |

---

## β… 2. μ „μ²΄ νλ¦„λ„

```
[1] fetch() β†’ /getComment.jsp λΉ„λ™κΈ° μ”μ²­
 β¬‡
[2] JSPμ—μ„ DB μ΅°ν ν›„ JSON λ°°μ—΄ μƒμ„±
 β¬‡
[3] ν΄λΌμ΄μ–ΈνΈ fetch().then(result β†’ ν™”λ©΄ μ¶λ ¥)
```

---

## β… 3. Ajax κµ¬μ„±μ”μ† ν•µμ‹¬

| μ”μ† | μ„¤λ… |
| --- | --- |
| μ”μ²­ λ°©μ‹ | `fetch()` λλ” `XMLHttpRequest` (`POST`, `GET`) |
| μ‘λ‹µ ν•μ‹ | `text`, `HTML`, `JSON` λ“± |
| μ„λ²„ μ‘λ‹µ μ²λ¦¬ | `.then(res => res.json())`, `.then(res => res.text())` |

---

## β… 4. ν΄λΌμ΄μ–ΈνΈ μ”μ²­ κµ¬μ΅° (fetch)

```jsx
fetch("getComment.jsp")
  .then(response => response.json())
  .then(data => {
    console.log("λ°›μ€ λ“κΈ€ λ©λ΅:", data);
  });
```

- `fetch()`λ” κΈ°λ³Έμ μΌλ΅ GET λ°©μ‹
- `response.json()`μΌλ΅ μ‘λ‹µμ„ JSONμΌλ΅ λ³€ν™

---

## β… 5. μ„λ²„ μ‘λ‹µ κµ¬μ΅° (JSP β†’ JSON μ‘λ‹µ)

### π“„ getComment.jsp

```
<%@ page contentType="application/json; charset=UTF-8" %>
<%@ page import="java.sql.*, java.util.*, org.json.simple.JSONArray, org.json.simple.JSONObject" %>

<%
  JSONArray arr = new JSONArray();

  Connection conn = DB.getConnection();
  String sql = "SELECT * FROM comments ORDER BY id DESC";
  PreparedStatement ps = conn.prepareStatement(sql);
  ResultSet rs = ps.executeQuery();

  while (rs.next()) {
    JSONObject obj = new JSONObject();
    obj.put("id", rs.getInt("id"));
    obj.put("content", rs.getString("content"));
    obj.put("regdate", rs.getString("regdate"));
    arr.add(obj);
  }

  conn.close();
  out.print(arr.toJSONString()); // JSON λ°°μ—΄λ΅ μ‘λ‹µ
%>
```

> β… μ„ μ½”λ“λ¥Ό μ‚¬μ©ν•λ ¤λ©΄ json-simple λΌμ΄λΈλ¬λ¦¬λ¥Ό lib ν΄λ”μ— μ¶”κ°€ν•΄μ•Ό ν•©λ‹λ‹¤.
> 

---

## β… 6. μ‹¤μ „ μμ : λ“κΈ€ λ©λ΅ λ¶λ¬μ¤κΈ°

---

### π“„ index.jsp

```html
<button id="loadBtn">λ“κΈ€ λ¶λ¬μ¤κΈ°</button>
<ul id="commentList"></ul>

<script>
document.getElementById("loadBtn").addEventListener("click", function () {
  fetch("getComment.jsp")
    .then(response => response.json())
    .then(list => {
      const ul = document.getElementById("commentList");
      ul.innerHTML = "";
      list.forEach(comment => {
        const li = document.createElement("li");
        li.innerText = comment.content + " (" + comment.regdate + ")";
        ul.appendChild(li);
      });
    });
});
</script>
```

---

## β… 7. κΈ°μ  λ©΄μ ‘ λ€λΉ„ ν•µμ‹¬ μ”μ•½ π’¬

| μ§λ¬Έ | μ”μ  μ •λ¦¬ |
| --- | --- |
| Ajaxλ€? | νμ΄μ§€λ¥Ό μƒλ΅κ³ μΉ¨ν•μ§€ μ•κ³  μ„λ²„μ™€ ν†µμ‹ ν•λ” λ°©μ‹ |
| fetchμ™€ JSPλ” μ–΄λ–»κ² μ—°λ™λλ‚μ”? | JSμ—μ„ fetch() β†’ JSPμ—μ„ DB μ²λ¦¬ ν›„ JSON μ‘λ‹µ |
| JSONμ΄λ€? | λ°μ΄ν„°λ¥Ό ν‚¤-κ°’ ν•μ‹μΌλ΅ μ£Όκ³ λ°›λ” κ²½λ‰ ν¬λ§· |
| JSPμ—μ„ JSON μ‘λ‹µμ„ λ§λ“¤λ ¤λ©΄? | JSONArray + JSONObject μ΅°ν•© μ‚¬μ© + contentType μ„¤μ • |

---

## β… 8. λ§λ¬΄λ¦¬ μ”μ•½ π§ 

- π” Ajax νλ¦„: fetch() β†’ JSP β†’ DB β†’ JSON μ‘λ‹µ β†’ JS μ¶λ ¥
- π JSPλ” μ„λ²„ μΈ΅μ—μ„ DB μ΅°ν ν›„ JSONμ„ μƒμ„±ν•λ” μ—­ν• 
- π“¦ ν΄λΌμ΄μ–ΈνΈλ” `.then(response.json())` μΌλ΅ μ‘λ‹µ μ²λ¦¬
- β… μ‹¤λ¬΄μ—μ„λ” λ“κΈ€, μ•λ¦Ό, κ²€μƒ‰ μλ™μ™„μ„± λ“±μ— ν•„μ μ‚¬μ©λ¨
