---
layout: post
title: "CHAP 10. GDA JSP í”„ë¡œì íŠ¸ ì¼ì§€ #10"
date: 2025-05-07
categories: [project, project-log]
tags: [JAVA, í”„ë¡œì íŠ¸, í•™ìŠµì¼ì§€]
thumbnail: /assets/img/post-thumbnails/intro9.png
author: Devchanny
---

# ðŸ“Œâ€œë™ì  SQLë¡œ ê°•ì˜ ê²€ìƒ‰ì„ ìœ ì—°í•˜ê²Œ â€“ LectureSqlProvider êµ¬í˜„ê¸°â€

ðŸ“… 2025-07-02 | âœï¸ ë°•ì°¬í¬

---

## ðŸ”§ ì™œ ì´ ê¸°ëŠ¥ì„ ì‹œìž‘í–ˆëŠ”ê°€?

ê°•ì˜ ê²€ìƒ‰ í™”ë©´ì„ ë§Œë“¤ë‹¤ ë³´ë‹ˆ ì´ëŸ° ìš”êµ¬ê°€ ìŸì•„ì¡Œë‹¤:

- ì¹´í…Œê³ ë¦¬ë³„ë¡œ ë‚˜ëˆ ì•¼ í•´ìš”
- ì œëª©ì— "Java"ê°€ ë“¤ì–´ê°„ ê°•ì˜ë§Œ ë³´ì—¬ì£¼ì„¸ìš”
- ì¸ê¸°ìˆœìœ¼ë¡œ ì •ë ¬í•´ì£¼ì„¸ìš”
- íŽ˜ì´ì§•ë„ ê¼­ í•„ìš”í•´ìš”

ì²˜ìŒì—ëŠ” ë‹¨ìˆœí•œ ì •ì  SQLë¡œ ì‹œìž‘í–ˆë‹¤.

í•˜ì§€ë§Œ ì¡°ê±´ì´ ëŠ˜ì–´ë‚ ìˆ˜ë¡ ì¿¼ë¦¬ëŠ” ë¬´ë„ˆì¡Œê³ ,

**if-elseì˜ ëŠª**ê³¼ **ë³µë¶™ SQL ì§€ì˜¥**ì´ ì‹œìž‘ëë‹¤.

ê·¸ëž˜ì„œ ê²°ë‹¨í–ˆë‹¤.

**ë™ì  SQL + MyBatis SQL Provider íŒ¨í„´**ìœ¼ë¡œ ì „í™˜í•´ì„œ,

ê°€ë…ì„±ê³¼ ìž¬ì‚¬ìš©ì„±ì„ ë™ì‹œì— ìž¡ê¸°ë¡œ.

---

## ðŸ§± ì„¤ê³„ êµ¬ì¡° í•œëˆˆì— ë³´ê¸°

| ê³„ì¸µ | ìš”ì†Œ | ì„¤ëª… |
| --- | --- | --- |
| DTO | `LectureSearchCondition` | ê²€ìƒ‰ ì¡°ê±´(ì¹´í…Œê³ ë¦¬, í‚¤ì›Œë“œ, ì •ë ¬, íŽ˜ì´ì§• ë“±) ì „ë‹¬ ê°ì²´ |
| Provider | `LectureSqlProvider` | `SELECT`, `COUNT` ì¿¼ë¦¬ ë™ì  ìƒì„± ë‹´ë‹¹ |
| Mapper | `LectureMapper.xml` | ë™ì  ì¿¼ë¦¬ ë¬¸ìžì—´ ë°”ì¸ë”© |
| Service | `LectureService` | ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ (ì¡°ê±´ ë¶„ê¸°, ì‘ë‹µ ë³€í™˜ ë“±) |

---

## ðŸ“Œ í•µì‹¬ ë©”ì„œë“œ ì„¤ê³„

### âœ… `findLectures(LectureSearchCondition cond)`

- ì¸ê¸°ìˆœ ì •ë ¬ ê°€ì¤‘ì¹˜ ì•Œê³ ë¦¬ì¦˜ ë‚´ìž¥:

```sql
(í‰ì  * 0.9) + (ë¦¬ë·° ìˆ˜ * 0.1) AS popularityScore
```

- ì¡°ì¸ êµ¬ì„±:

```sql
FROM lectures l
LEFT OUTER JOIN user_interactions ui
  ON l.lecture_id = ui.target_id
  AND ui.target_type = 'LECTURE'
  AND ui.interaction_kind = 'FEEDBACK'
```

- ì¡°ê±´ ë¶„ê¸°:

```java
if (cond.getKeyword() != null) {
  WHERE("title LIKE ... OR description LIKE ...");
}
```

- ì •ë ¬ ë™ì  êµ¬ì„±:

```java
if ("popular".equals(cond.getSort())) {
  ORDER_BY("popularityScore DESC");
} else {
  ORDER_BY("l.created_at DESC");
}
```

ðŸ“Œ ì‹¤ì‹œê°„ ì¸ê¸°ìˆœì„ ë§Œë“¤ì–´ë‚´ê¸° ìœ„í•´ ë°ì´í„°ë¥¼ "ì •ë ¬ ê°€ëŠ¥ ì§€í‘œ"ë¡œ ê°€ê³µí•´ì„œ ë„£ëŠ” ê²Œ í•µì‹¬ì´ì—ˆë‹¤.

ì´ëŸ° ì •ë ¬ ì§€í‘œëŠ” **UXì™€ ë°ì´í„° ê¸°ë°˜ ì¶”ì²œì˜ ì ˆì¶©ì§€ì **ì´ ëœë‹¤.

---

### âœ… `countLectures(LectureSearchCondition cond)`

- SELECT êµ¬ë¬¸ì€ ë‹¨ìˆœí•˜ì§€ë§Œ,
    
    ì¡°ê±´ í•„í„°ë§ì€ ì¡°íšŒ ì¿¼ë¦¬ì™€ ë™ì¼í•˜ê²Œ ë§žì·„ë‹¤.
    

```sql
SELECT COUNT(DISTINCT l.lecture_id)
```

- GROUP BY ì—†ì´ ì¡°ì¸ë§Œ ìœ ì§€ â†’ Count ì„±ëŠ¥ ìµœì í™”
    
    ðŸ“Œ ë¦¬ìŠ¤íŠ¸ ì¡°íšŒì™€ íŽ˜ì´ì§• ì¹´ìš´íŠ¸ë¥¼ ë³„ë„ë¡œ ë¶„ë¦¬í•˜ë©´,
    
    íŽ˜ì´ì§• ìš”ì²­ ì„±ëŠ¥ì„ **10ë°° ì´ìƒ ê°œì„ **í•  ìˆ˜ ìžˆë‹¤.
    

---

## ðŸ§ª í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤ ìš”ì•½

| ì¡°ê±´ ì˜ˆì‹œ | ê¸°ëŒ€ SQL ë™ìž‘ |
| --- | --- |
| ì¡°ê±´ ì—†ìŒ | ì „ì²´ ê°•ì˜ ìµœì‹ ìˆœ ì¡°íšŒ |
| keyword = "Java" | WHERE title LIKE '%Java%' OR description ... |
| category = "ì›¹" | WHERE l.category = 'ì›¹' |
| sort = "popular" | ORDER BY popularityScore DESC |
| size = 20, offset = 10 | LIMIT 10, 20 |

âœ… ëª¨ë“  ì¿¼ë¦¬ëŠ” ì½˜ì†” ë¡œê·¸ë¡œ ì§ì ‘ ì¶œë ¥í•˜ì—¬ ì¿¼ë¦¬ ì •í™•ì„± ê²€ì¦ ì™„ë£Œ

---

## ðŸš§ êµ¬í˜„ ì¤‘ ê²ªì€ ë¬¸ì œ

### âŒ ë¬¸ì œ: ì •ë ¬ ì¡°ê±´ì´ ìžê¾¸ ëˆ„ë½ë¨

- ì›ì¸: `ORDER_BY(...)`ë¥¼ `if`ë¬¸ ì•ˆì—ì„œ ìž‘ì„±í–ˆëŠ”ë°, `SQL()` ê°ì²´ ë‚´ë¶€ì— ì ìš©ë˜ì§€ ì•ŠìŒ
- í•´ê²°: ëª¨ë“  `ORDER_BY`ëŠ” ì¿¼ë¦¬ ë¸”ë¡ì˜ **ë§ˆì§€ë§‰ì— ê³ ì • ìœ„ì¹˜**ë¡œ ë°°ì¹˜í•´ì•¼ ì•ˆì •ì  ì ìš©ë¨

---

## ðŸ“ˆ ì‹¤ë¬´í˜• ìµœì í™” ì „ëžµ

| í•­ëª© | ì „ëžµ | ì´ìœ  |
| --- | --- | --- |
| SQL ê°ì²´ êµ¬ì„± | `org.apache.ibatis.jdbc.SQL` | ê°€ë…ì„± + ìœ ì§€ë³´ìˆ˜ì„± í™•ë³´ |
| ì •ë ¬ ì ìˆ˜ ê³„ì‚° | í‰ì  + ë¦¬ë·°ìˆ˜ | ì¶”ì²œ ì•Œê³ ë¦¬ì¦˜ ê°„ì†Œí™” ë° ì‹¤ì‹œê°„ UX ë³´ìž¥ |
| í‚¤ì›Œë“œ ê²€ìƒ‰ | title + description ë™ì‹œ LIKE | ê²€ìƒ‰ ë§Œì¡±ë„ í–¥ìƒ |
| íŽ˜ì´ì§• ë°©ì‹ | `LIMIT #{offset}, #{size}` | ë°ì´í„° ì–‘ì´ ë§Žì•„ë„ ì„±ëŠ¥ ìœ ì§€ |
| LEFT OUTER JOIN | ë¦¬ë·° ì—†ëŠ” ê°•ì˜ í¬í•¨ | ê°•ì˜ ë‹¤ì–‘ì„± í™•ë³´ |

---

## ðŸ”­ ì•žìœ¼ë¡œì˜ í™•ìž¥ ê³„íš

| ê¸°ëŠ¥ | ì„¤ëª… |
| --- | --- |
| ðŸ“Š ì •ë ¬ ê¸°ì¤€ ì¶”ê°€ | ë¦¬ë·°ë§Žì€ìˆœ, ê°€ê²©ë‚®ì€ìˆœ, ë¬´ë£Œë§Œ ë³´ê¸° ë“± |
| ðŸ”„ ì¸ê¸° ì ìˆ˜ ê°œì„  | ì¡°íšŒìˆ˜, ì°œ ìˆ˜ ë“± í¬í•¨í•œ ë‹¤ì¤‘ ê°€ì¤‘ì¹˜ ëª¨ë¸ |
| ðŸŒ ë‹¤êµ­ì–´ ì§€ì› | `title_kr`, `title_en` ë¶„ê¸° ì²˜ë¦¬ |
| ðŸš€ ElasticSearch ì—°ë™ | ëŒ€ìš©ëŸ‰ ì¡°ê±´ ê²€ìƒ‰ ì„±ëŠ¥ í–¥ìƒ |
| âœ… ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ | Provider í•¨ìˆ˜ë³„ `assertSQLEquals` í…ŒìŠ¤íŠ¸ ìž‘ì„± ì˜ˆì • |

---

## âœï¸ íšŒê³ 

ì´ë²ˆ `LectureSqlProvider` ìž‘ì—…ì€ ë‹¨ìˆœí•œ SQL ë¦¬íŒ©í† ë§ì´ ì•„ë‹ˆì—ˆë‹¤.

ê·¸ ì•ˆì—ëŠ” ë‹¤ìŒê³¼ ê°™ì€ êµí›ˆì´ ìžˆì—ˆë‹¤:

> ðŸ’¡ â€œì¡°ê±´ì´ ëŠ˜ì–´ë‚˜ëŠ” ì‹œìŠ¤í…œì¼ìˆ˜ë¡, ì¿¼ë¦¬ëŠ” ì‚¬ëžŒì´ ì½ì„ ìˆ˜ ìžˆì–´ì•¼ í•œë‹¤.â€
> 

MyBatisì˜ `SQL()` ê°ì²´ëŠ” ë‹¨ìˆœí•œ ë¬¸ë²•ì´ ì•„ë‹ˆë¼,

**ë„ë©”ì¸ ë¡œì§ì„ SQL ìˆ˜ì¤€ì—ì„œ ë¶„ë¦¬í•˜ê³  í…ŒìŠ¤íŠ¸ ê°€ëŠ¥í•œ ì½”ë“œë¡œ ë§Œë“¤ ìˆ˜ ìžˆëŠ” ë°©ë²•ë¡ **ì´ì—ˆë‹¤.

ê·¸ë¦¬ê³  ë¬´ì—‡ë³´ë‹¤,

**ë°±ì—”ë“œ ì„¤ê³„ê°€ ì¢‹ì•„ì•¼ í”„ë¡ íŠ¸ê°€ ë‹¨ìˆœí•´ì§„ë‹¤.**

ì¡°ê±´ë§Œ ë„˜ê¸°ë©´ ê·¸ì— ë§žëŠ” ê°•ì˜ ëª©ë¡ì„ ì •êµí•˜ê²Œ ì¿¼ë¦¬í•´ì£¼ëŠ” ì´ êµ¬ì¡°ëŠ”

ì‹¤ë¬´ì—ì„œ API ì„¤ê³„ì˜ í•µì‹¬ì´ ë¬´ì—‡ì¸ì§€ ë‹¤ì‹œ í•œë²ˆ ê¹¨ë‹«ê²Œ í–ˆë‹¤.

## âœ… í•œ ë¬¸ìž¥ ìš”ì•½

> "MyBatis SQL Provider íŒ¨í„´ìœ¼ë¡œ ì¡°ê±´ ê¸°ë°˜ ê°•ì˜ ê²€ìƒ‰ì„ ì •êµí•˜ê²Œ êµ¬ì„±í•˜ì—¬, ìœ ì§€ë³´ìˆ˜ì„±ê³¼ UX ì¤‘ì‹¬ì˜ ì‹¤ì‹œê°„ ì¶”ì²œ êµ¬ì¡°ë¥¼ ì™„ì„±í–ˆë‹¤."
>
