---
layout: post
title: "CHAP2-12. ê´€ë¦¬ì í˜ì´ì§€ êµ¬í˜„"
date: 2025-05-17
categories: [backend, language, jsp]
tags: [backend, language, jsp]
thumbnail: /assets/img/post-thumbnails/intro18.png
author: Devchanny
---


# ** ğŸ“Œ ê´€ë¦¬ì í˜ì´ì§€ êµ¬í˜„ **

> ê´€ë¦¬ìë§Œ ì ‘ê·¼ ê°€ëŠ¥í•œ ì „ì²´ ë¦¬ìŠ¤íŠ¸, ì‚­ì œ, ê¶Œí•œ ë³€ê²½ ê¸°ëŠ¥ êµ¬í˜„
> 
> 
> íšŒì› ë¦¬ìŠ¤íŠ¸ ê´€ë¦¬ë¶€í„° ì‚­ì œ/ë³€ê²½ ì²˜ë¦¬ê¹Œì§€ ì™„ì „ ì •ë¦¬
> 

---

## ğŸ§© ëª©ì°¨

1. ê´€ë¦¬ì í˜ì´ì§€ë€?
2. ì „ì²´ ê¸°ëŠ¥ íë¦„ë„
3. ê¸°ëŠ¥ë³„ ì—­í•  ì •ë¦¬
4. ì‹¤ì „ ì˜ˆì œ ì½”ë“œ
5. ê´€ë¦¬ì ê¶Œí•œ ì²´í¬ ë° ê¸°ëŠ¥ ì˜ˆì‹œ
6. ê¸°ìˆ  ë©´ì ‘ ëŒ€ë¹„ í•µì‹¬ ìš”ì•½
7. ë§ˆë¬´ë¦¬ ìš”ì•½ + Notion ì‘ì„± íŒ

---

## âœ… 1. ê´€ë¦¬ì í˜ì´ì§€ë€?

| í•­ëª© | ì„¤ëª… |
| --- | --- |
| ì •ì˜ | ì¼ë°˜ ì‚¬ìš©ìê°€ ì•„ë‹Œ ê´€ë¦¬ì(admin)ë§Œ ì ‘ê·¼ ê°€ëŠ¥í•œ ê´€ë¦¬ í˜ì´ì§€ |
| ëª©ì  | íšŒì› ì •ë³´, ê²Œì‹œê¸€, ê¶Œí•œ ë“±ì„ í™•ì¸í•˜ê³  ì œì–´í•  ìˆ˜ ìˆìŒ |
| ì¡°ê±´ | ì„¸ì…˜ì— ì €ì¥ëœ ë¡œê·¸ì¸ ì•„ì´ë””ê°€ ê´€ë¦¬ì(`admin`)ì¼ ë•Œë§Œ ì ‘ê·¼ ê°€ëŠ¥ |

---

## âœ… 2. ì „ì²´ ê¸°ëŠ¥ íë¦„ë„

```
[1] admin.jsp ì ‘ì† ìš”ì²­
 â¬‡
[2] ì„¸ì…˜ ê²€ì‚¬ â†’ ë¡œê·¸ì¸ IDê°€ 'admin'ì¸ì§€ í™•ì¸
 â¬‡
[3] ê´€ë¦¬ìì¼ ê²½ìš° â†’ DAOì—ì„œ ì „ì²´ ëª©ë¡ ì¡°íšŒ
 â¬‡
[4] list ì¶œë ¥ + ì‚­ì œ or ê¶Œí•œë³€ê²½ ë²„íŠ¼ í™œì„±í™”
 â¬‡
[5] ì‚­ì œ í´ë¦­ ì‹œ â†’ /delete?id=3 ì‹¤í–‰
[6] ê¶Œí•œë³€ê²½ í´ë¦­ ì‹œ â†’ /roleChange?id=3 ì‹¤í–‰
```

---

## âœ… 3. ê¸°ëŠ¥ë³„ ì—­í•  ì •ë¦¬

| ê¸°ëŠ¥ | ì—­í•  |
| --- | --- |
| âœ… ê´€ë¦¬ì ì¸ì¦ | ë¡œê·¸ì¸ ì„¸ì…˜ì˜ IDê°€ 'admin'ì¸ì§€ í™•ì¸ |
| ğŸ“‹ íšŒì› ë¦¬ìŠ¤íŠ¸ ì¶œë ¥ | ì „ì²´ ì‚¬ìš©ì ëª©ë¡ì„ ì¶œë ¥ (DAOì—ì„œ `SELECT *`) |
| âŒ íšŒì› ì‚­ì œ | ì„ íƒí•œ íšŒì›ì˜ IDë¥¼ ì „ë‹¬ë°›ì•„ `DELETE` ì‹¤í–‰ |
| ğŸ” ê¶Œí•œ ë³€ê²½ | ì¼ë°˜íšŒì› â†’ ê´€ë¦¬ì or ê´€ë¦¬ì â†’ ì¼ë°˜íšŒì›ìœ¼ë¡œ ë³€ê²½ |

---

## âœ… 4. ì‹¤ì „ ì˜ˆì œ ì½”ë“œ ğŸ¯

---

### ğŸ“„ [1] admin.jsp

```
<%
  String loginId = (String) session.getAttribute("loginId");
  if (!"admin".equals(loginId)) {
%>
  <script>
    alert("ê´€ë¦¬ìë§Œ ì ‘ê·¼ ê°€ëŠ¥í•©ë‹ˆë‹¤.");
    location.href = "login.jsp";
  </script>
<%
    return;
  }
%>

<%@ page import="java.util.*, yourpackage.MemberDTO" %>
<%
  List<MemberDTO> list = (List<MemberDTO>) request.getAttribute("list");
%>

<h2>íšŒì› ê´€ë¦¬ í˜ì´ì§€</h2>
<table border="1">
  <tr>
    <th>ì•„ì´ë””</th>
    <th>ì´ë¦„</th>
    <th>ê¶Œí•œ</th>
    <th>ê´€ë¦¬</th>
  </tr>
<% for(MemberDTO dto : list) { %>
  <tr>
    <td><%= dto.getUserid() %></td>
    <td><%= dto.getName() %></td>
    <td><%= dto.getRole() %></td>
    <td>
      <a href="delete?id=<%= dto.getId() %>">ì‚­ì œ</a> |
      <a href="roleChange?id=<%= dto.getId() %>">ê¶Œí•œë³€ê²½</a>
    </td>
  </tr>
<% } %>
</table>
```

---

### ğŸ“„ [2] AdminServlet.java â€“ ê´€ë¦¬ì ëª©ë¡ ì¡°íšŒ

```java
@WebServlet("/admin")
public class AdminServlet extends HttpServlet {
  protected void doGet(HttpServletRequest req, HttpServletResponse resp)
      throws ServletException, IOException {

    String loginId = (String) req.getSession().getAttribute("loginId");
    if (!"admin".equals(loginId)) {
      resp.sendRedirect("login.jsp");
      return;
    }

    MemberDAO dao = new MemberDAO();
    List<MemberDTO> list = dao.selectAll();
    req.setAttribute("list", list);
    RequestDispatcher rd = req.getRequestDispatcher("admin.jsp");
    rd.forward(req, resp);
  }
}
```

---

### ğŸ“„ [3] MemberDAO.java â€“ ê¶Œí•œë³€ê²½ / ì‚­ì œ ë©”ì„œë“œ

```java
// ì‚­ì œ ë©”ì„œë“œ
public void delete(int id) {
  try {
    Connection conn = DB.getConnection();
    String sql = "DELETE FROM members WHERE id=?";
    PreparedStatement ps = conn.prepareStatement(sql);
    ps.setInt(1, id);
    ps.executeUpdate();
    conn.close();
  } catch (Exception e) {
    e.printStackTrace();
  }
}

// ê¶Œí•œ ë³€ê²½ ë©”ì„œë“œ (admin â†” user)
public void toggleRole(int id) {
  try {
    Connection conn = DB.getConnection();
    String sql = "UPDATE members SET role = IF(role='admin', 'user', 'admin') WHERE id=?";
    PreparedStatement ps = conn.prepareStatement(sql);
    ps.setInt(1, id);
    ps.executeUpdate();
    conn.close();
  } catch (Exception e) {
    e.printStackTrace();
  }
}
```

---

### ğŸ“„ [4] RoleChangeServlet.java

```java
@WebServlet("/roleChange")
public class RoleChangeServlet extends HttpServlet {
  protected void doGet(HttpServletRequest req, HttpServletResponse resp)
      throws ServletException, IOException {
    int id = Integer.parseInt(req.getParameter("id"));
    MemberDAO dao = new MemberDAO();
    dao.toggleRole(id);
    resp.sendRedirect("admin");
  }
}
```

---

### ğŸ“„ [5] DeleteServlet.java

```java
@WebServlet("/delete")
public class DeleteServlet extends HttpServlet {
  protected void doGet(HttpServletRequest req, HttpServletResponse resp)
      throws ServletException, IOException {
    int id = Integer.parseInt(req.getParameter("id"));
    MemberDAO dao = new MemberDAO();
    dao.delete(id);
    resp.sendRedirect("admin");
  }
}
```

---

## âœ… 5. ê´€ë¦¬ì ê¸°ëŠ¥ ì˜ˆì‹œ

| ê¸°ëŠ¥ | URL ì˜ˆì‹œ | ì„¤ëª… |
| --- | --- | --- |
| íšŒì› ëª©ë¡ ë³´ê¸° | `/admin` | ëª¨ë“  íšŒì› ì¶œë ¥ |
| íšŒì› ì‚­ì œ | `/delete?id=3` | 3ë²ˆ íšŒì› ì‚­ì œ |
| ê¶Œí•œ ë³€ê²½ | `/roleChange?id=3` | 3ë²ˆ íšŒì›ì˜ ê¶Œí•œ í† ê¸€ |

---

## âœ… 6. ê¸°ìˆ  ë©´ì ‘ ëŒ€ë¹„ í•µì‹¬ ìš”ì•½ ğŸ’¬

| ì§ˆë¬¸ | ìš”ì  ì •ë¦¬ |
| --- | --- |
| ê´€ë¦¬ì í˜ì´ì§€ì— ì ‘ê·¼ ì¡°ê±´ì€? | `ì„¸ì…˜ ê°’ì´ 'admin'ì¸ì§€` ê²€ì‚¬ |
| ê¶Œí•œ ë³€ê²½ì€ ì–´ë–»ê²Œ í•˜ë‚˜ìš”? | `UPDATE` ì¿¼ë¦¬ì—ì„œ `IF(role='admin', 'user', 'admin')` |
| ì‚­ì œ ì‹œ ì•ˆì „í•˜ê²Œ ì²˜ë¦¬í•˜ë ¤ë©´? | íŒŒë¼ë¯¸í„°ë¡œ ID ì „ë‹¬ â†’ `PreparedStatement` ì‚¬ìš© |
| ì¼ë°˜ ì‚¬ìš©ìì™€ ê´€ë¦¬ì êµ¬ë¶„ ë°©ì‹ì€? | members í…Œì´ë¸”ì˜ `role` ì»¬ëŸ¼ ê°’ìœ¼ë¡œ êµ¬ë¶„ |

---

## âœ… 7. ë§ˆë¬´ë¦¬ ìš”ì•½ ğŸ§ 

- âœ… ê´€ë¦¬ì í˜ì´ì§€ëŠ” **ì„¸ì…˜ ê²€ì‚¬ â†’ ì „ì²´ ì¶œë ¥ â†’ ì‚­ì œ/ë³€ê²½** íë¦„ìœ¼ë¡œ ì„¤ê³„
- ğŸ” ì„¸ì…˜ì´ â€˜adminâ€™ì¼ ê²½ìš°ì—ë§Œ ì ‘ê·¼ í—ˆìš© (ë³´ì•ˆ í•„ìˆ˜!)
- ğŸ”„ ê¶Œí•œ ë³€ê²½ì€ SQL `IF()` í•¨ìˆ˜ë¡œ í† ê¸€ ë°©ì‹ êµ¬í˜„
- âœ‚ï¸ ì‚­ì œëŠ” URL íŒŒë¼ë¯¸í„°ë¡œ ID ì „ë‹¬ í›„ DAOì—ì„œ ì²˜ë¦¬
