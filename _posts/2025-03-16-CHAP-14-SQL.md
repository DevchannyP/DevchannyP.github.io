---
layout: post
title: "CHAP 14. 데이터 관리 및 유지보수 "
date: 2025-03-16
categories: [sql]
tags: [Database, SQL]
thumbnail: /assets/img/post-thumbnails/intro14.png
author: Devchanny
---


# 📌 1️⃣ 데이터 무결성 유지 방법**

### 📌 **데이터 무결성(Data Integrity)란?**

> 데이터가 정확하고 일관되며 신뢰할 수 있는 상태를 유지하는 것
> 

### 🎯 **무결성 유형**

| 유형 | 설명 | 예시 |
| --- | --- | --- |
| **엔터티 무결성** | 기본키는 반드시 **고유하고 NULL 불가** | 학생 테이블에서 학번은 중복 X, NULL X |
| **도메인 무결성** | 컬럼 값은 미리 정한 **형식과 범위** 내여야 함 | 나이는 0~~150, 전화번호는 숫자 10~~11자리 |
| **참조 무결성** | **외래키 값은 부모 테이블에 반드시 존재**해야 함 | 주문 테이블의 고객ID는 고객 테이블에 반드시 있어야 함 |
| **사용자 정의 무결성** | 비즈니스 룰에 맞는 조건 | 예: 직원 급여는 100만원 이상 |

---

### 🛡️ **무결성 유지 방법**

### 1️⃣ **제약조건(CONSTRAINT) 설정**

- PRIMARY KEY, FOREIGN KEY, CHECK, UNIQUE, NOT NULL

### 2️⃣ **트랜잭션(Transaction) 관리**

- ACID 원칙 준수:
    - **Atomicity (원자성)**
    - **Consistency (일관성)**
    - **Isolation (격리성)**
    - **Durability (지속성)**

### 3️⃣ **정기적인 검증 및 스크립트 활용**

- 데이터 유효성 검사 스크립트 주기적 실행*(예: 잘못된 외래키 값 검사)*

---

### 🎬 **비유로 이해하기: 놀이공원 관리**

놀이공원에서는 **입장권(기본키)**을 반드시 소지해야 입장 가능

- 입장권이 중복되거나 없으면 출입 불가 (**엔터티 무결성**)
놀이기구마다 **탑승 제한(도메인 무결성)**: 키 120cm 이상
친구 따라 함께 온 사람은, 반드시 그 친구가 입장해야 입장 가능 (**참조 무결성**)
추가로 "VIP 고객은 놀이기구 무제한 이용 가능" 같은 **특별 규칙(사용자 정의 무결성)**

---

---

## 📂 **2️⃣ 주기적인 데이터 아카이빙 및 정리**

### 📌 **아카이빙(Archiving)이란?**

> 자주 사용하지 않는 데이터를 별도의 저장소로 이동시켜, 시스템 성능을 유지하는 것
> 

### 🎯 **왜 필요한가?**

| 이유 | 설명 |
| --- | --- |
| **성능 향상** | 운영 테이블에 불필요한 데이터 제거 → 쿼리 속도 향상 |
| **스토리지 효율성** | 오래된 데이터는 저렴한 스토리지로 이동 |
| **규정 준수** | 데이터 보관 기간 정책 준수 (예: 개인정보 5년 보관 후 삭제 등) |

---

### 🛠️ **주요 방법**

1️⃣ **파티셔닝 + 파티션 이동**

- 예: 월별 데이터 파티션 생성 → 1년 지난 파티션은 외부 스토리지로 이동

2️⃣ **아카이빙 전용 테이블로 이관**

- `ARCHIVE` 엔진 사용 가능 (MariaDB)

3️⃣ **압축 및 외부 파일로 백업 (CSV, JSON)**

→ 장기 보관 후 필요 시만 불러오기

---

### 🎬 **비유: 창고 정리**

창고에 매일 쌓이는 물건들!

오래된 물건은 **별도 보관소**로 옮기고, 자주 쓰는 물건은 바로 앞에!

→ 창고가 깔끔하면 찾기 쉽고 관리가 편함

(DB도 오래된 데이터가 정리되어야 빠름)

---

---

## 🔥 **3️⃣ 장애 복구 및 복원 전략**

### 📌 **핵심 전략**

| 전략 | 설명 | 사용 예시 |
| --- | --- | --- |
| **정기 백업** | 전체, 증분, 차등 백업 수행 | 매일 새벽 전체 백업, 매시간 증분 백업 |
| **로그 활용 (PITR)** | 바이너리 로그로 특정 시점까지 복구 | 장애 직전 1분 전까지 되돌리기 |
| **고가용성(HA) 구성** | 이중화(Replication, Cluster)로 장애 시 자동 전환 | Master-Slave Replication |
| **복구 시나리오 문서화** | 장애 발생 시 누구나 대응 가능하도록 절차화 | 복구 매뉴얼 작성 및 연습 |

---

### 🎬 **비유: 소방 시스템**

건물 화재 발생 시:

1. **스프링클러(Replication)** 자동 작동
2. **비상구(Backup)** 통해 안전하게 대피
3. *소방훈련(복구 시나리오 연습)**으로 빠른 대응

---

---

## 🚀 **4️⃣ 대규모 시스템에서의 성능 관리**

### 📌 **성능 관리 핵심 요소**

| 방법 | 설명 | 예시 |
| --- | --- | --- |
| **인덱스 최적화** | 자주 사용하는 쿼리에 적절한 인덱스 추가 | B-Tree, Fulltext |
| **쿼리 튜닝** | 느린 쿼리 분석 → JOIN, WHERE, LIMIT 최적화 | EXPLAIN 사용 |
| **파티셔닝** | 테이블을 파티션으로 나눠 쿼리 범위 축소 | 월별 로그 테이블 |
| **Connection Pool 관리** | DB 연결 수 제한, 과부하 방지 | max_connections 조정 |
| **캐싱** | Redis, Memcached 활용해 자주 조회하는 데이터 캐싱 | 세션, 조회수 등 |

---

### 🎬 **비유: 고속도로 교통 관리**

- **인덱스 = 네비게이션의 최적 경로**
- **쿼리 튜닝 = 차선 변경, 속도 조절**
- **파티셔닝 = 고속도로 톨게이트 구간별 분리**
- **Connection Pool = 입장 차량 수 제한**
- **캐싱 = 자주 쓰는 하이패스 티켓 준비**

---

---

## 📝 **🔖  요약**

---

# 📊 데이터 관리 & 유지보수

### 🛡️ **1. 데이터 무결성 유지**

- ✅ 제약조건 (PK, FK, CHECK)
- ✅ 트랜잭션 관리 (ACID)
- ✅ 정기적 데이터 검증 스크립트*🎬 놀이공원 입장권 비유*

---

### 📂 **2. 주기적 데이터 아카이빙**

- ✅ 파티셔닝 후 데이터 이동
- ✅ 아카이빙 전용 테이블 사용
- ✅ 외부 파일 압축 백업*🎬 창고 정리 비유*

---

### 🔥 **3. 장애 복구 & 복원 전략**

- ✅ 전체/증분 백업
- ✅ PITR로 특정 시점 복구
- ✅ 복구 시나리오 문서화*🎬 소방 시스템 비유*

---

### 🚀 **4. 대규모 시스템 성능 관리**

- ✅ 인덱스 최적화
- ✅ 쿼리 튜닝 + EXPLAIN
- ✅ 파티셔닝 & 캐싱 활용*🎬 고속도로 교통 비유*

---
